
# 难点说明

## 难点

- VSCode 不提供字母方式的中文补全，只能通过中文输入法来输入中文。
- 实现中文补全，需要通过 VSCode 提供的补全接口，自行编写补全插件。

- VSCode 补全接口的「常规」使用方法可通过 AI 了解。
- 实现的比较满意的方面（）
- 接下来我们只讲述开发过程中的存在的一些问题和「特殊」解决方法。

## 实现策略

**我们采取了一些方法来规避「VSCode 接口」和「各语言支持插件」的不足：**

1、矫正补全锚点

> 有些语言服务器（如：Python 、Java）会做补全项的预过滤，根据当前光标是获取不到中文补全项的（已被语言服务器根据输入的字母过滤掉了）。
>获取之类语言的补全项，需要把补全锚点矫正到输入字母之前。

2、缓存补全项

> 有些特殊代码行，需要在起始阶段缓存补全项，后续阶段使用缓存（如：Python 的导入（无法通过矫正补全锚点，只能通过缓存的方式））

_通过以上方法，我们规避了大部分问题。只是受限于 VSCode 和相关语言服务器，有少数问题确实无法解决（通常影响很小）。_
_当然如果您有能力可以向 VSCode 和相关语言服务器提供补丁，或根据 VSCode 源代码自行构建一个中文友好的版本。_

## 当前局限

**少数无法规避的问题：**

1、部分语言服务器不提供「去重」

- VSCode 的机制：一个插件可以给出和收回自己的补全项，也可以获取其他插件给出的补全项（不能修改）。
- 扩展性好的语言服务器（如：JavaScript）会先提供全部补全项，然后再采纳其他插件的补全建议（如我们给出的中文补全项）。
- 扩展性不好的语言服务器（如：Python 、Java）既不提供全部补全项，也不管其他插件会不会提出补全建议。

2、部分语言服务器在实现某些补全时会绕过常规方式

- XML 的枚举属性，在创建时绕过了常规补全机制（我们的补全不会被唤起，只能使用方向键选择 或 输入中文定位枚举项）
- Python 的 super().c 、super().s  和 super().cs 无法唤起（只会显示 __class__ 可能是它觉得既然已经匹配到了）
- C# 的 override 可以匹配，但无法上内容（C# 的 override 补全项是内容是一个特殊对象（非 label 文本））
- Java 的 super 参数绕过了常规补全机制